# AI Trip Planner ğŸ—ºï¸âœˆï¸

> An AI-powered travel itinerary generator with interactive maps, real-time place discovery, PDF export, and trip sharing â€” built with Vanilla JS, Leaflet, and Google Gemini / Groq AI.

[![Netlify Status](https://api.netlify.com/api/v1/badges/b6c9161e-4862-4733-a554-e2911e243341/deploy-status)](https://app.netlify.com/projects/my-trip-genie/deploys)
---

## ğŸ“‘ Table of Contents

- [Overview](#overview)
- [Live Demo](#live-demo)
- [Features](#features)
- [Tech Stack](#tech-stack)
- [Project Structure](#project-structure)
- [Data Schemas](#data-schemas)
- [API Integrations](#api-integrations)
- [Environment Variables](#environment-variables)
- [Local Development](#local-development)
- [Deploying to Netlify](#deploying-to-netlify)
- [Architecture Notes](#architecture-notes)
- [Contributing](#contributing)

---

## Overview

AI Trip Planner generates a full day-by-day travel itinerary for any set of Indian (or international) destinations using large language models. It clusters nearby attractions geographically, schedules them in realistic time blocks (10 AM â†’ 6 PM), estimates entry fees, and renders everything on an interactive map.

Users can:
- Input destinations + travel dates
- Pre-specify custom places they want to visit (from the home screen)
- Browse and select from AI-discovered famous places
- Search for more attractions near a specific area
- Generate a structured, time-slotted itinerary
- Download the itinerary as a rich PDF (with place thumbnails) or emoji-rich plain text
- Save trips locally + share via URL

---

## Live Demo

> https://ai-trip-genie.netlify.app

---

## Features

| Feature | Description |
|---|---|
| ğŸ¤– Multi-provider AI | Gemini 2.0 Flash â†’ Gemini 2.0 Flash-Lite â†’ Groq Llama â†’ Groq Mixtral (auto-fallback) |
| ğŸ—ºï¸ Interactive Map | Leaflet + OpenStreetMap: pin-drop markers, day-focus, polyline routes, popups with images |
| ğŸ“… Realistic Scheduling | Day starts 10 AM, places ordered by `arrivalTime` with actual visit durations |
| ğŸ“ Geographic Clustering | AI groups places within ~5 km radius on the same day |
| ğŸ” Place Discovery | Photon-geocoded "Search Nearby" with AI-powered results |
| ğŸ“¸ Place Images | Unsplash API (context-aware: name + city query) with Picsum fallback |
| ğŸ’¾ Save & Share | localStorage save (up to 5 trips) + URL hash sharing |
| ğŸ“„ Rich PDF Export | jsPDF: place thumbnails, colored day banners, commute info, entry fee breakdown |
| ğŸ“‹ Emoji Copy Text | WhatsApp-friendly itinerary with flag emojis, time slots, â†’ arrows |
| ğŸ’° Budget Estimator | Per-day entry fee tally (tickets only, travel excluded) |
| ğŸŒ™ Dark/Light Theme | Persisted in localStorage; Leaflet tiles switch automatically |
| ğŸ“± Mobile Responsive | Full 480px breakpoint with stacked layouts |
| âš¡ Session Caching | AI responses + images cached in `sessionStorage`; debounced requests |

---

## Tech Stack

| Layer | Technology |
|---|---|
| Core | Vanilla HTML5, JavaScript ES Modules |
| Styling | Vanilla CSS (CSS custom properties, no build step) |
| Maps | [Leaflet.js](https://leafletjs.com/) 1.9 + CartoDB tiles |
| AI (primary) | [Google Gemini API](https://ai.google.dev/) â€” `gemini-2.0-flash` |
| AI (fallback) | [Groq API](https://groq.com/) â€” `llama-3.3-70b-versatile`, `mixtral-8x7b-32768` |
| Images | [Unsplash API](https://unsplash.com/developers) |
| Geocoding | [Photon API](https://photon.komoot.io/) (OpenStreetMap-backed, no key required) |
| PDF | [jsPDF](https://github.com/parallax/jsPDF) 2.5 (CDN) |
| Deployment | [Netlify](https://netlify.com/) (static hosting + env injection via build script) |

---

## Project Structure

```
AI-Trip-Planner-main/
â”œâ”€â”€ index.html              # Single-page app shell (all screens)
â”œâ”€â”€ build-env.js            # Netlify build script: injects API keys â†’ js/env.js
â”œâ”€â”€ package.json            # Build script + dev server config
â”‚
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ style.css           # Global tokens, resets, typography, theme variables
â”‚   â””â”€â”€ components.css      # All component-level styles (accordion, map, modalsâ€¦)
â”‚
â””â”€â”€ js/
    â”œâ”€â”€ env.js              # API keys (git-ignored; generated by build-env.js)
    â”œâ”€â”€ app.js              # â˜… Main orchestrator: state, screen routing, UI logic
    â”œâ”€â”€ api.js              # AI provider abstraction: Gemini + Groq calls, JSON repair
    â”œâ”€â”€ maps.js             # Leaflet integration: markers, popups, focus, polylines
    â””â”€â”€ download.js         # Export: emoji copy text, rich PDF with thumbnails
```

### Screen Flow

```
screen-input  â”€â”€[Plan My Trip]â”€â”€â–º  screen-progress
                                        â”‚
                                        â–¼
screen-itinerary  â—„â”€â”€[Generate Itinerary]â”€â”€  screen-discovery
        â”‚                                          â”‚
        â”‚                                    [Search Nearby]
        â”‚                                    [Load More]
        â–¼
  [Download PDF / TXT / Copy / Save / Share]
```

---

## Data Schemas

### `Place`
```typescript
interface Place {
  name:          string;           // Display name
  location:      string;           // City/area (e.g. "New Delhi")
  shortDesc?:    string;           // 1-line teaser
  desc?:         string;           // 2â€“3 sentence full description
  category?:     'Heritage' | 'Nature' | 'Religious' | 'Market' | 'Museum' | 'Entertainment' | 'Food';
  openingHours?: string;           // e.g. "9:00 AM â€“ 6:00 PM"
  entryFee?:     string;           // e.g. "â‚¹40" or "Free"
  arrivalTime?:  string;           // e.g. "10:00 AM" (computed by AI per-day schedule)
  visitDuration?: string;          // e.g. "2 hrs"
  bestTime?:     string;           // e.g. "Early morning before crowds"
  closedNote?:   string;           // e.g. "Closed Mondays"
  lat?:          number;           // WGS84 decimal latitude
  lng?:          number;           // WGS84 decimal longitude
  commute_from_prev?: Commute;     // Transit info from previous day's place
}
```

### `Commute`
```typescript
interface Commute {
  walk:  string;   // e.g. "12 min (900m)" | "N/A"
  cab:   string;   // e.g. "â‚¹80â€“120" | "N/A"
  metro: string;   // e.g. "Yellow Line â†’ Rajiv Chowk (â‚¹30)" | "N/A"
}
```

### `Day`
```typescript
interface Day {
  day:      number;    // Day number (1-indexed)
  date:     string;    // ISO date "YYYY-MM-DD"
  theme:    string;    // Creative day title e.g. "Mughal Grandeur & Old Delhi"
  location: string;    // Primary city/area for this day
  places:   Place[];
}
```

### `Itinerary`
```typescript
interface Itinerary {
  summary: string;   // 1â€“2 line trip overview
  days:    Day[];
}
```

### `AppState` (runtime)
```typescript
interface AppState {
  locations:     string[];    // Selected destination cities
  startDate:     string;      // ISO date
  endDate:       string;      // ISO date
  places:        Place[];     // All discovered places
  imageCache:    Record<string, string>;   // name â†’ Unsplash URL
  autoMode:      boolean;     // AI picks places vs. user selection
  selectedPlaces: Place[];
  itinerary:     Itinerary | null;
  aiProvider:    string;      // Last AI that responded
  config:        { geminiKey: string; groqKey: string; unsplashKey: string };
}
```

---

## API Integrations

### Google Gemini
- **Endpoint:** `https://generativelanguage.googleapis.com/v1beta/models/{model}:generateContent`
- **Models (priority order):** `gemini-2.0-flash` â†’ `gemini-2.0-flash-lite`
- **Used for:** Famous place discovery, itinerary generation, nearby search
- **Rate limits:** Free tier ~15 RPM / 1M TPD; handled via multi-provider fallback

### Groq
- **Endpoint:** `https://api.groq.com/openai/v1/chat/completions`
- **Models:** `llama-3.3-70b-versatile`, `mixtral-8x7b-32768`
- **Used for:** Fallback when Gemini quota is exhausted
- **Rate limits:** Free tier generous; recommended primary for local testing

### Unsplash
- **Endpoint:** `https://api.unsplash.com/search/photos`
- **Query strategy:** `"{place name} {city} landmark"` for location-specific results
- **Fallback:** `https://picsum.photos/seed/{hash}/400/300` (no key required)

### Photon (OpenStreetMap Geocoding)
- **Endpoint:** `https://photon.komoot.io/api/?q={query}&limit=6&lang=en`
- **Used for:** Location autocomplete on the input screen
- **Key required:** None âœ… CORS-free âœ…

---

## Environment Variables

Set these in the **Netlify dashboard** under `Site Settings â†’ Environment Variables`:

| Variable | Description | Required |
|---|---|---|
| `GEMINI_API_KEY` | Google AI Studio API key | Recommended |
| `GROQ_API_KEY` | Groq Cloud API key | Recommended |
| `UNSPLASH_ACCESS_KEY` | Unsplash developer access key | Optional (Picsum fallback) |

> **Security:** Keys are injected at build time by `build-env.js` into `js/env.js`, which is `.gitignore`d. Keys are **never** committed or exposed in the repository.

### Getting API Keys

| Provider | URL | Free Tier |
|---|---|---|
| Gemini | https://aistudio.google.com/apikey | âœ… Yes |
| Groq | https://console.groq.com/keys | âœ… Yes |
| Unsplash | https://unsplash.com/developers | âœ… 50 req/hr |

---

## Local Development

```bash
# 1. Clone
git clone https://github.com/sdukesameer/AI-Trip-Planner.git
cd AI-Trip-Planner

# 2. Install deps (only needed for the dev server)
npm install

# 3. Set up your local API keys
cp js/env.example.js js/env.js
# Edit js/env.js and paste your API keys

# 4. Start dev server (serves on http://localhost:3000)
npm run dev
```

> **No build step required.** The app uses native ES modules â€” no bundler, no transpilation.

---

## Deploying to Netlify

1. Push your repository to GitHub
2. Connect the repo to [Netlify](https://app.netlify.com/)
3. Set **Build command:** `node build-env.js`
4. Set **Publish directory:** `.` (root)
5. Add environment variables in `Site Settings â†’ Environment Variables`
6. Deploy ğŸ‰

`build-env.js` reads the Netlify environment variables and writes `js/env.js` before the site is published. The generated file is excluded via `.gitignore`.

---

## Architecture Notes

### Multi-Provider AI Fallback
`api.js` exports `smartAICall()` which tries providers in sequence. Each provider's response is run through `extractJSON()` which applies a 3-stage repair pipeline:
1. Strip markdown fences (` ```json ... ``` `)
2. Remove trailing commas (common LLM mistake)
3. Truncate to the last complete JSON object if response is cut off

### Session Caching
All AI responses are cached in `sessionStorage` using a composite key of `(type, locations, dates, selectedPlaces)`. This prevents re-querying when the user navigates between screens within the same browser session.

### Geographic Clustering in the AI Prompt
The itinerary prompt includes concrete examples of clusters (e.g., India Gate + Rajpath + War Memorial â†’ same day) and pass known `lat/lng` coordinates of selected places as hints. The AI is instructed to calculate `arrivalTime` cumulatively: Place N + visitDuration + transit â†’ Place N+1.

### Map Safety
`clearMarkers()` in `maps.js` wraps every `map.removeLayer()` call in a `try/catch`. The map is fully torn down (`map.off(); map.remove()`) before re-initialization on screen navigation, preventing `_leaflet_id` null errors on saved-trip load.

---

## Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/your-feature`
3. Make changes following the existing code style (vanilla JS, no build tools)
4. Test locally with `npm run dev`
5. Open a PR with a clear description of what you changed and why

### Code Style
- Vanilla JS ES Modules (no TypeScript, no bundler)
- CSS custom properties for all colors/spacing (see `style.css` `:root`)
- Keep `app.js` as the orchestrator; logic belongs in `api.js`, `maps.js`, or `download.js`
- Always use `showToast()` for user feedback â€” never `alert()`

---

## License

MIT License â€” free to use, modify, and distribute.

---

*Generated itineraries are for planning purposes only. Check official sources for current opening hours, entry fees, and closures before visiting.*
